{"version":3,"file":"index.cjs.development.cjs","sources":["../src/index.ts"],"sourcesContent":["import { ITSPickExtra, ITSRequiredPick } from 'ts-type/lib/type/record';\nimport { parseStack, formatMessagePrefix, IParsed } from 'error-stack2';\n\nexport interface IErrStackMeta<E extends Error> extends ITSRequiredPick<IParsed, 'rawTrace' | 'type'>\n{\n\tprefix: string;\n\tmessage: string;\n\tstack: string;\n\terror: E;\n}\n\nexport function errStackMeta<E extends Error>(error: E): IErrStackMeta<E>\n{\n\tlet es = parseStack(error.stack, error.message);\n\n\treturn {\n\t\ttype: es.type,\n\t\tprefix: formatMessagePrefix(es) + ': ',\n\t\tmessage: es.message,\n\t\trawTrace: es.rawTrace,\n\t\tstack: es.rawTrace.join('\\n'),\n\t\terror,\n\t}\n}\n\nexport function stringifyStackMeta(meta: ITSPickExtra<IErrStackMeta<any>, 'prefix' | 'message'>, stack?: string)\n{\n\tstack ??= meta.stack;\n\n\tif (stack.length)\n\t{\n\t\tstack = `\\n${stack}`;\n\t}\n\n\treturn `${meta.prefix}${meta.message ?? ''}${stack}`\n}\n\nexport default errStackMeta\n"],"names":["errStackMeta","error","es","parseStack","stack","message","type","prefix","formatMessagePrefix","rawTrace","join","stringifyStackMeta","meta","_stack","_meta$message","length"],"mappings":";;;;;;AAWM,SAAUA,YAAYA,CAAkBC,KAAQ,EAAA;EAErD,IAAIC,EAAE,GAAGC,sBAAU,CAACF,KAAK,CAACG,KAAK,EAAEH,KAAK,CAACI,OAAO,CAAC,CAAA;EAE/C,OAAO;IACNC,IAAI,EAAEJ,EAAE,CAACI,IAAI;AACbC,IAAAA,MAAM,EAAEC,+BAAmB,CAACN,EAAE,CAAC,GAAG,IAAI;IACtCG,OAAO,EAAEH,EAAE,CAACG,OAAO;IACnBI,QAAQ,EAAEP,EAAE,CAACO,QAAQ;IACrBL,KAAK,EAAEF,EAAE,CAACO,QAAQ,CAACC,IAAI,CAAC,IAAI,CAAC;AAC7BT,IAAAA,KAAAA;GACA,CAAA;AACF,CAAA;AAEgB,SAAAU,kBAAkBA,CAACC,IAA4D,EAAER,KAAc,EAAA;EAAA,IAAAS,MAAA,EAAAC,aAAA,CAAA;AAE9G,EAAA,CAAAD,MAAA,GAAAT,KAAK,MAAA,IAAA,IAAAS,MAAA,KAAA,KAAA,CAAA,GAAAA,MAAA,GAALT,KAAK,GAAKQ,IAAI,CAACR,KAAK,CAAA;EAEpB,IAAIA,KAAK,CAACW,MAAM,EAChB;IACCX,KAAK,GAAG,CAAKA,EAAAA,EAAAA,KAAK,CAAE,CAAA,CAAA;AACrB,GAAA;AAEA,EAAA,OAAO,GAAGQ,IAAI,CAACL,MAAM,CAAAO,EAAAA,CAAAA,aAAA,GAAGF,IAAI,CAACP,OAAO,MAAA,IAAA,IAAAS,aAAA,KAAAA,KAAAA,CAAAA,GAAAA,aAAA,GAAI,EAAE,CAAA,EAAGV,KAAK,CAAE,CAAA,CAAA;AACrD;;;;;;"}