{"version":3,"file":"index.esm.mjs","sources":["../src/index.ts"],"sourcesContent":["import { ITSPickExtra, ITSRequiredPick } from 'ts-type/lib/type/record';\nimport { parseStack, formatMessagePrefix, IParsed } from 'error-stack2';\n\nexport interface IErrStackMeta<E extends Error> extends ITSRequiredPick<IParsed, 'rawTrace' | 'type'>\n{\n\tprefix: string;\n\tmessage: string;\n\tstack: string;\n\terror: E;\n}\n\nexport function errStackMeta<E extends Error>(error: E): IErrStackMeta<E>\n{\n\tlet es = parseStack(error.stack, error.message);\n\n\treturn {\n\t\ttype: es.type,\n\t\tprefix: formatMessagePrefix(es) + ': ',\n\t\tmessage: es.message,\n\t\trawTrace: es.rawTrace,\n\t\tstack: es.rawTrace.join('\\n'),\n\t\terror,\n\t}\n}\n\nexport function stringifyStackMeta(meta: ITSPickExtra<IErrStackMeta<any>, 'prefix' | 'message'>, stack?: string)\n{\n\tstack ??= meta.stack;\n\n\tif (stack.length)\n\t{\n\t\tstack = `\\n${stack}`;\n\t}\n\n\treturn `${meta.prefix}${meta.message ?? ''}${stack}`\n}\n\nexport default errStackMeta\n"],"names":["errStackMeta","error","es","parseStack","stack","message","type","prefix","formatMessagePrefix","rawTrace","join","stringifyStackMeta","meta","_stack","_meta$message","length"],"mappings":";;AAWM,SAAUA,aAA8BC;EAE7C,IAAIC,IAAKC,EAAWF,EAAMG,OAAOH,EAAMI;EAEvC,OAAO;IACNC,MAAMJ,EAAGI;IACTC,QAAQC,EAAoBN,KAAM;IAClCG,SAASH,EAAGG;IACZI,UAAUP,EAAGO;IACbL,OAAOF,EAAGO,SAASC,KAAK;IACxBT;;AAEF;;AAEgB,SAAAU,mBAAmBC,GAA8DR;EAAc,IAAAS,GAAAC;EAS9G,OAPK,UAALD,IAAAT,WAAK,MAAAS,MAALT,IAAUQ,EAAKR,QAEXA,EAAMW,WAETX,IAAQ,KAAKA;EAGP,GAAGQ,EAAKL,SAAqB,UAAfO,IAAGF,EAAKP,iBAAOS,MAAAA,IAAAA,IAAI,KAAKV;AAC9C;;"}